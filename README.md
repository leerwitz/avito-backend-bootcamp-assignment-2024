# avito-backend-bootcamp-assignment-2024

Тз: https://github.com/avito-tech/backend-bootcamp-assignment-2024

## Сборка

Чтобы собрать приложение напишите команду: 
```bash
    docker-compose up -d --build
```
Чтобы удалить контейнеры: 
```bash
    docker-compose down
```
## Тесты

Чтобы запустить введите 1 из команд в терминале: 
Все тесты: 
```bash
    go test ./...
```
Только модульные тесты:
```bash
    go test ./internal/router
```
Только интеграционные тесты:
```bash
    go test ./tests
```

Чтобы увидеть более подробную информацию добавьте -v
Например:
```bash
    go test -v ./...
```

## О реализации 
В тз в общие вводные -> связи между сущностями был пункт про то что номер дома служит уникальным идентификатором самого дома, но в апи тело ручки get /house/create не подовался номер, только адрес, так что было решено сделать id просто некоторое уникальное целое число, на а если номер дома нужен где то, то его взять из адреса например. 

С другой стороны для квартиры было то, что в сущности должен быть номер квартиры а также квартиры в одном доме не могут имет одинаковые номера, но в апи у сущности квартиры самое близкое к номеру квартиры было поле id, но тогда, если сделать id номером квартиры запрос на обновление статуса квартиры будет неоднозначен, тк у него в теле лежит id квартиры, но может быть такое, что есть несколько квартир с одним id, но в разных домах, по типу (1, 1), (1, 2), где пара (id, house_id) - (номер квартирыб номер дома), крч поэтому было отдельно добавлено поле flat_num - номер квартиры и   так же реализована уникальность пар (flaat_num, house_id). 

И последнее, в том же тз чтобы оеализовать 7 пункт про обновление статусов квартир было добавлено поле moderator_id в сущность квартиры, это id последнего модераторо, который изменил статус объявления на "on moderation", также чтобы это корректно работало следует отправлять id модератора в теле запроса. На этом все, извините за эту душнятину :)
(p.s Надо сделать это покороче)

## Замечания
При сборке таблицы создаются и заполняются тестовыми данными, данные и таблицы можно посмотреть в директории /tables
Интеграционные тесты должны быть запущены и тестовыми данными, при изменении данных результаты тестов будут некорректны.
В каждом запросе где требуется авторизация, следует указывать заголовок "Authorization" с токеном авторизации, иначе считается что пользователь не авторизован. Время жизни токена 15 минут. 